<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pixel Seed - 项目需求文档</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'Helvetica Neue', Helvetica, Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f5f5f5;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: white;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
            border-radius: 8px;
            margin-top: 20px;
            margin-bottom: 20px;
        }
        
        .header {
            text-align: center;
            padding: 40px 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 8px 8px 0 0;
            margin: -20px -20px 40px -20px;
        }
        
        .header h1 {
            font-size: 3em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }
        
        .nav {
            position: sticky;
            top: 0;
            background: white;
            padding: 15px 0;
            border-bottom: 2px solid #eee;
            margin-bottom: 30px;
            z-index: 100;
        }
        
        .nav ul {
            list-style: none;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
        }
        
        .nav a {
            color: #667eea;
            text-decoration: none;
            padding: 8px 16px;
            border-radius: 20px;
            transition: all 0.3s ease;
            font-weight: 500;
        }
        
        .nav a:hover {
            background: #667eea;
            color: white;
            transform: translateY(-2px);
        }
        
        h1, h2, h3, h4 {
            color: #2c3e50;
            margin-top: 30px;
            margin-bottom: 15px;
        }
        
        h1 {
            font-size: 2.5em;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
        }
        
        h2 {
            font-size: 2em;
            color: #667eea;
            border-left: 4px solid #667eea;
            padding-left: 15px;
        }
        
        h3 {
            font-size: 1.5em;
            color: #764ba2;
        }
        
        h4 {
            font-size: 1.2em;
            color: #555;
        }
        
        p {
            margin-bottom: 15px;
            text-align: justify;
        }
        
        ul, ol {
            margin-left: 30px;
            margin-bottom: 15px;
        }
        
        li {
            margin-bottom: 8px;
        }
        
        .mermaid {
            text-align: center;
            margin: 30px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
            border: 1px solid #e9ecef;
        }
        
        code {
            background: #f4f4f4;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
        }
        
        pre {
            background: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 20px 0;
        }
        
        pre code {
            background: none;
            padding: 0;
            color: inherit;
        }
        
        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: bold;
            margin-left: 10px;
        }
        
        .status-completed {
            background: #d4edda;
            color: #155724;
        }
        
        .status-pending {
            background: #fff3cd;
            color: #856404;
        }
        
        .status-warning {
            background: #f8d7da;
            color: #721c24;
        }
        
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .feature-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }
        
        .feature-card h4 {
            margin-top: 0;
            color: #667eea;
        }
        
        .back-to-app {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #667eea;
            color: white;
            padding: 15px 25px;
            border-radius: 50px;
            text-decoration: none;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
            transition: all 0.3s ease;
            z-index: 1000;
        }
        
        .back-to-app:hover {
            background: #5a67d8;
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
        }
        
        @media (max-width: 768px) {
            .container {
                margin: 10px;
                padding: 15px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .nav ul {
                flex-direction: column;
                align-items: center;
            }
            
            .back-to-app {
                bottom: 20px;
                right: 20px;
                padding: 12px 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🎮 PIXEL SEED</h1>
            <p>基于 AI 生成的 2D 像素风网页游戏 - 项目需求文档</p>
        </div>
        
        <nav class="nav">
            <ul>
                <li><a href="#overview">项目概述</a></li>
                <li><a href="#features">功能需求</a></li>
                <li><a href="#ui">用户界面</a></li>
                <li><a href="#architecture">技术架构</a></li>
                <li><a href="#current-arch">当前架构</a></li>
                <li><a href="#ai-flow">AI生成流程</a></li>
                <li><a href="#status">实现状态</a></li>
                <li><a href="#roadmap">扩展计划</a></li>
            </ul>
        </nav>
        
        <section id="overview">
            <h1>项目概述</h1>
            <p><strong>"用一粒 AI 种子，生长无限像素世界"</strong></p>
            <p>Pixel Seed 是一款实验性 2D 像素风网页游戏，核心创新在于：游戏内容完全由用户输入的"种子"（主题/提示词）驱动。用户无需美术基础，仅需选择预设主题（如史诗魔幻、赛博朋克）或输入自定义提示词，系统即调用大模型生成专属的像素风角色形象和关卡背景，动态构建游戏世界。这验证了 AI 作为"创造源头"的潜力——将提示词转化为可玩的像素宇宙。</p>
            
            <h3>1. 项目背景</h3>
            <p>传统像素游戏开发受限于美术资源制作周期长、风格固化。随着AI图像生成技术的发展，尤其是大模型在风格化图像生成上的突破，我们有机会构建一个"AI即内容引擎"的游戏平台。</p>
            <p><strong>Pixel Seed</strong> 旨在通过大语言模型 + 图像生成模型，实现"输入一个种子（Seed），生成一个世界"的愿景——用户只需选择或输入一个主题，即可获得风格一致的像素游戏角色与场景，快速进入可玩的游戏体验。</p>
            
            <h3>2. 项目目标</h3>
            <ul>
                <li>实现"AI生成+即时游戏化"的闭环流程。</li>
                <li>验证使用大模型生成高质量、风格统一的像素美术资源的可行性。</li>
                <li>构建可扩展的架构，支持未来加入更多游戏玩法、主题风格和交互机制。</li>
            </ul>
            
            <h3>3. 核心理念</h3>
            <blockquote style="background: #f8f9fa; padding: 20px; border-left: 4px solid #667eea; margin: 20px 0; font-style: italic;">
                <strong>"A Seed, A World."</strong><br>
                每一次生成，都是一次独特的创造。AI 是世界的"种子"，玩家是世界的"探索者"。
            </blockquote>
        </section>
        
        <section id="features">
            <h1>功能需求</h1>
            
            <h2>1. 主题选择系统 <span class="status-badge status-completed">已实现</span></h2>
            
            <div class="feature-grid">
                <div class="feature-card">
                    <h4>1.1 预设主题</h4>
                    <ul>
                        <li><strong>史诗魔幻</strong>：包含魔法、龙、城堡、森林等元素</li>
                        <li><strong>赛博朋克</strong>：包含霓虹灯、机械、未来城市等元素</li>
                    </ul>
                </div>
                
                <div class="feature-card">
                    <h4>1.2 自定义主题</h4>
                    <ul>
                        <li>用户可手动输入提示词</li>
                        <li>支持中英文输入</li>
                        <li>提供提示词建议和示例</li>
                        <li>200字符限制</li>
                    </ul>
                </div>
            </div>
            
            <h2>2. AI内容生成系统 <span class="status-badge status-pending">待实现</span></h2>
            
            <div class="feature-grid">
                <div class="feature-card">
                    <h4>2.1 角色生成</h4>
                    <ul>
                        <li>基于选定主题生成像素风角色形象</li>
                        <li>支持主角、NPC、敌人等不同类型角色</li>
                        <li>生成多个动作帧（行走、跳跃、攻击等）</li>
                    </ul>
                </div>
                
                <div class="feature-card">
                    <h4>2.2 关卡背景生成</h4>
                    <ul>
                        <li>生成符合主题的关卡背景</li>
                        <li>包含前景、中景、背景层次</li>
                        <li>支持不同关卡类型（地面、地下、空中等）</li>
                    </ul>
                </div>
            </div>
            
            <h2>3. 游戏玩法系统 <span class="status-badge status-completed">已实现</span></h2>
            
            <h3>3.1 游戏渲染方案</h3>
            <ul>
                <li><strong>混合方案</strong>：背景使用CSS，角色使用绝对定位（已采用）</li>
            </ul>
            
            <h3>3.2 基础交互功能 (已实现)</h3>
            <ul>
                <li><strong>角色显示</strong>：使用绝对定位在游戏区域显示角色</li>
                <li><strong>背景展示</strong>：CSS背景图片作为游戏场景</li>
                <li><strong>基础动画</strong>：
                    <ul>
                        <li>角色方向翻转（左右移动时scaleX变化）</li>
                        <li>平滑的位置过渡动画</li>
                        <li>暂停状态的淡入淡出效果</li>
                    </ul>
                </li>
                <li><strong>角色移动</strong>：
                    <ul>
                        <li>多键位支持：WASD + 方向键</li>
                        <li>跳跃动作：W键、上方向键、空格键</li>
                        <li>下蹲移动：S键、下方向键</li>
                        <li>实时位置更新和边界限制</li>
                    </ul>
                </li>
            </ul>
            
            <h3>3.3 技术实现细节 (已实现)</h3>
            <ul>
                <li><strong>静态场景</strong>：当前为展示版本，无碰撞检测和敌人系统</li>
                <li><strong>键盘监听</strong>：使用Set数据结构管理多键同时按下</li>
                <li><strong>游戏循环</strong>：setInterval实现16ms间隔的游戏循环</li>
                <li><strong>状态管理</strong>：Zustand管理游戏状态、角色位置、动作状态</li>
                <li><strong>重力系统</strong>：简单的重力效果，角色自动下落到地面</li>
                <li><strong>暂停机制</strong>：ESC键暂停/恢复游戏</li>
            </ul>
        </section>
        
        <section id="ui">
            <h1>用户界面 (已实现)</h1>
            
            <div class="feature-grid">
                <div class="feature-card">
                    <h4>4.1 主菜单 (已实现)</h4>
                    <ul>
                        <li>项目标题和描述展示</li>
                        <li>主题选择功能</li>
                        <li>开始游戏按钮</li>
                        <li>响应式布局设计</li>
                    </ul>
                </div>
                
                <div class="feature-card">
                    <h4>4.2 主题选择界面 (已实现)</h4>
                    <ul>
                        <li><strong>预设主题卡片</strong>：Epic Fantasy 和 Cyberpunk 主题</li>
                        <li><strong>自定义输入框</strong>：支持200字符限制的自定义主题输入</li>
                        <li><strong>主题预览</strong>：显示主题描述和示例元素</li>
                        <li><strong>确认和重试按钮</strong>：主题确认和重置功能</li>
                        <li><strong>Radio组件</strong>：使用Ant Design Radio实现主题选择</li>
                    </ul>
                </div>
                
                <div class="feature-card">
                    <h4>4.3 游戏界面 (已实现)</h4>
                    <ul>
                        <li><strong>游戏画布</strong>：使用CSS背景 + 绝对定位的混合渲染方案</li>
                        <li><strong>控制提示</strong>：底部显示WASD/方向键操作说明</li>
                        <li><strong>实时信息面板</strong>：显示角色位置、当前动作和游戏状态</li>
                        <li><strong>暂停功能</strong>：ESC键暂停游戏，显示暂停遮罩</li>
                        <li><strong>返回主菜单</strong>：游戏内返回功能</li>
                        <li><strong>移动端适配</strong>：响应式设计，支持不同屏幕尺寸</li>
                    </ul>
                </div>
                
                <div class="feature-card">
                    <h4>4.4 加载界面 (已实现)</h4>
                    <ul>
                        <li><strong>进度条显示</strong>：使用Ant Design Progress组件</li>
                        <li><strong>加载状态提示</strong>：动态显示生成进度信息</li>
                        <li><strong>模拟生成过程</strong>：当前使用模拟进度，待接入真实API</li>
                    </ul>
                </div>
            </div>
            
            <h3>4.5 游戏画布技术规格 (已实现)</h3>
            <ul>
                <li><strong>Canvas尺寸</strong>：全屏响应式设计，适配不同设备</li>
                <li><strong>角色位置</strong>：初始位置(100, 400)，x轴移动范围0-800</li>
                <li><strong>背景处理</strong>：CSS background-size: cover 自适应</li>
                <li><strong>动画帧率</strong>：16ms间隔实现60fps游戏循环</li>
                <li><strong>重力系统</strong>：简单的重力效果，地面高度350px</li>
            </ul>
        </section>
        
        <section id="architecture">
            <h1>技术架构</h1>
            
            <h2>前端技术栈</h2>
            <ul>
                <li><strong>框架</strong>：Next.js 15.5.2 (已实现)</li>
                <li><strong>样式</strong>：Tailwind CSS 4.0 (已实现)</li>
                <li><strong>游戏渲染</strong>：混合方案 - 背景使用CSS，角色使用Canvas (已实现)</li>
                <li><strong>状态管理</strong>：Zustand 5.0.8 (已实现)</li>
                <li><strong>UI组件</strong>：Ant Design 5.27.1 (已实现)</li>
                <li><strong>HTTP客户端</strong>：Fetch API (待实现)</li>
                <li><strong>动画库</strong>：Framer Motion 12.23.12 (已实现)</li>
                <li><strong>图标库</strong>：Ant Design Icons 6.0.0 + Lucide React 0.542.0 (已实现)</li>
            </ul>
            
            <h2>后端技术栈</h2>
            <ul>
                <li><strong>API路由</strong>：Next.js API Routes</li>
                <li><strong>数据库</strong>：PostgreSQL + Prisma ORM</li>
                <li><strong>文件存储</strong>：AWS S3 或 Cloudinary</li>
                <li><strong>缓存</strong>：Redis（可选）</li>
                <li><strong>队列处理</strong>：Bull Queue（处理AI生成任务）</li>
            </ul>
            
            <h2>AI集成</h2>
            <ul>
                <li><strong>图像生成模型</strong>：Qwen-Image (通过DashScope API)</li>
                <li><strong>API端点</strong>：https://dashscope.aliyuncs.com/api/v1/services/aigc/multimodal-generation/generation</li>
                <li><strong>认证方式</strong>：Bearer Token</li>
                <li><strong>调用方式</strong>：HTTP同步接口，发送POST请求后立即返回结果</li>
                <li><strong>图像处理</strong>：Sharp.js 进行格式转换和优化</li>
                <li><strong>并发控制</strong>：Promise.all 并行处理角色和背景生成</li>
            </ul>
        </section>
        
        <section id="current-arch">
            <h1>当前项目架构图</h1>
            
            <h2>系统架构图</h2>
            <div class="mermaid">
graph TB
    subgraph "前端层 (已实现)"
        A["Next.js 15.5.2 应用"]
        B["Ant Design UI 组件"]
        C["Framer Motion 动画"]
        D["Tailwind CSS 样式"]
    end
    
    subgraph "状态管理层 (已实现)"
        E["Zustand Store"]
        F["游戏状态管理"]
        G["角色位置追踪"]
        H["主题选择状态"]
    end
    
    subgraph "游戏渲染层 (已实现)"
        I["CSS 背景渲染"]
        J["绝对定位角色"]
        K["键盘事件监听"]
        L["游戏循环 (16ms)"]
    end
    
    subgraph "AI生成层 (待实现)"
        M["DashScope API"]
        N["Qwen-Image 模型"]
        O["图像处理"]
    end
    
    A --> B
    A --> C
    A --> D
    A --> E
    E --> F
    E --> G
    E --> H
    F --> I
    F --> J
    K --> L
    L --> G
    A -.-> M
    M -.-> N
    N -.-> O
            </div>
            
            <h2>用户交互流程图</h2>
            <div class="mermaid">
flowchart TD
    Start(["用户访问应用"]) --> Menu["主菜单界面"]
    Menu --> ThemeSelect{"选择主题类型"}
    
    ThemeSelect -->|"预设主题"| PresetTheme["Epic Fantasy / Cyberpunk"]
    ThemeSelect -->|"自定义主题"| CustomTheme["输入自定义提示词"]
    
    PresetTheme --> Confirm["确认主题选择"]
    CustomTheme --> Confirm
    
    Confirm --> Generate["点击开始游戏"]
    Generate --> Loading["显示生成进度"]
    Loading --> GameInterface["进入游戏界面"]
    
    GameInterface --> GamePlay{"游戏交互"}
    GamePlay -->|"WASD/方向键"| Movement["角色移动"]
    GamePlay -->|"空格键"| Jump["角色跳跃"]
    GamePlay -->|"ESC键"| Pause["暂停游戏"]
    
    Movement --> GamePlay
    Jump --> GamePlay
    Pause --> Resume{"继续游戏?"}
    Resume -->|"是"| GamePlay
    Resume -->|"否"| BackToMenu["返回主菜单"]
    BackToMenu --> Menu
    
    GameInterface --> Restart["重新生成"]
    Restart --> Generate
            </div>
        </section>
        
        <section id="ai-flow">
            <h1>AI生成流程设计 (待实现)</h1>
            
            <h2>生成流程时序图</h2>
            <div class="mermaid">
sequenceDiagram
    participant User
    participant Frontend
    participant Backend
    participant QwenImage
    User->>Frontend: 点击"生成"
    Frontend->>Backend: POST /api/generate (含提示词)
    Backend->>Backend: 拆分请求
    Backend->>QwenImage: 调用角色生成API
    QwenImage-->>Backend: 返回角色图
    Backend->>QwenImage: 调用背景生成API
    QwenImage-->>Backend: 返回背景图
    Backend-->>Frontend: 统一响应 {character, background}
    Frontend->>User: 显示预览 + "开始游戏"按钮
            </div>
            
            <h2>详细实现流程</h2>
            
            <h3>1. 前端交互流程</h3>
            <ol>
                <li><strong>用户选择主题</strong>：用户在主题选择界面选择预设主题或输入自定义提示词</li>
                <li><strong>点击生成按钮</strong>：触发生成请求，显示加载状态</li>
                <li><strong>实时进度显示</strong>：通过WebSocket或轮询显示生成进度</li>
                <li><strong>预览展示</strong>：生成完成后展示角色和背景预览</li>
                <li><strong>确认开始</strong>：用户确认满意后点击"开始游戏"按钮</li>
            </ol>
            
            <h3>2. 后端处理流程</h3>
            <ol>
                <li><strong>请求接收</strong>：接收前端POST请求，验证参数</li>
                <li><strong>提示词构建</strong>：根据主题和用户输入构建具体的提示词</li>
                <li><strong>并行生成</strong>：同时调用DashScope Qwen-Image API生成角色和背景</li>
                <li><strong>图像处理</strong>：对生成的图像进行格式转换和优化</li>
                <li><strong>资源存储</strong>：将生成的图像上传到云存储</li>
                <li><strong>响应返回</strong>：返回包含角色和背景URL的统一响应</li>
            </ol>
        </section>
        
        <section id="status">
            <h1>当前实现状态</h1>
            
            <h2>已完成功能 ✅</h2>
            <div class="feature-grid">
                <div class="feature-card">
                    <h4>基础架构</h4>
                    <ul>
                        <li>Next.js + TypeScript + Tailwind CSS</li>
                        <li>Ant Design 完整集成</li>
                        <li>Zustand 全局状态管理</li>
                    </ul>
                </div>
                
                <div class="feature-card">
                    <h4>用户界面</h4>
                    <ul>
                        <li>主题选择系统：预设主题 + 自定义主题输入</li>
                        <li>响应式设计：移动端适配</li>
                        <li>游戏界面：完整的UI布局</li>
                    </ul>
                </div>
                
                <div class="feature-card">
                    <h4>游戏系统</h4>
                    <ul>
                        <li>游戏渲染引擎：CSS + 绝对定位混合方案</li>
                        <li>角色控制系统：多键位支持 + 重力系统</li>
                        <li>动画系统：Framer Motion 平滑过渡</li>
                        <li>游戏循环：60fps 实时更新</li>
                        <li>暂停功能：ESC键暂停/恢复</li>
                    </ul>
                </div>
            </div>
            
            <h2>待实现功能 🚧</h2>
            <div class="feature-grid">
                <div class="feature-card">
                    <h4>AI生成集成</h4>
                    <ul>
                        <li>DashScope API 接入</li>
                        <li>图像处理：生成图片的格式转换和优化</li>
                        <li>错误处理：生成失败重试机制</li>
                    </ul>
                </div>
                
                <div class="feature-card">
                    <h4>后端开发</h4>
                    <ul>
                        <li>Next.js API Routes</li>
                        <li>数据持久化：游戏数据存储</li>
                        <li>文件存储：云存储集成</li>
                    </ul>
                </div>
            </div>
            
            <h2>技术债务 ⚠️</h2>
            <ul>
                <li><strong>模拟数据</strong>：当前使用占位符图片，需接入真实AI生成</li>
                <li><strong>性能优化</strong>：游戏循环可优化为requestAnimationFrame</li>
                <li><strong>类型安全</strong>：部分组件props类型定义待完善</li>
                <li><strong>测试覆盖</strong>：缺少单元测试和集成测试</li>
            </ul>
        </section>
        
        <section id="roadmap">
            <h1>后续扩展计划</h1>
            
            <h2>短期扩展 (1-2周)</h2>
            <div class="feature-grid">
                <div class="feature-card">
                    <h4>AI生成集成</h4>
                    <p>完成DashScope API接入，实现真实的AI图像生成功能</p>
                </div>
                
                <div class="feature-card">
                    <h4>真实图片渲染</h4>
                    <p>替换占位符为AI生成内容，完善图像处理流程</p>
                </div>
                
                <div class="feature-card">
                    <h4>错误处理优化</h4>
                    <p>完善生成失败的用户体验，添加重试机制</p>
                </div>
                
                <div class="feature-card">
                    <h4>性能优化</h4>
                    <p>游戏循环和渲染优化，提升整体性能</p>
                </div>
            </div>
            
            <h2>中期扩展 (1-2月)</h2>
            <div class="feature-grid">
                <div class="feature-card">
                    <h4>更多预设主题</h4>
                    <p>科幻、恐怖、卡通等风格主题</p>
                </div>
                
                <div class="feature-card">
                    <h4>基础碰撞检测</h4>
                    <p>角色与环境交互系统</p>
                </div>
                
                <div class="feature-card">
                    <h4>简单的收集元素</h4>
                    <p>道具和奖励系统</p>
                </div>
                
                <div class="feature-card">
                    <h4>音效生成集成</h4>
                    <p>AI生成背景音乐和音效</p>
                </div>
            </div>
            
            <h2>长期扩展 (3-6月)</h2>
            <div class="feature-grid">
                <div class="feature-card">
                    <h4>完整游戏引擎集成</h4>
                    <p>考虑Phaser.js或自研引擎</p>
                </div>
                
                <div class="feature-card">
                    <h4>多关卡系统</h4>
                    <p>程序化关卡生成</p>
                </div>
                
                <div class="feature-card">
                    <h4>敌人和障碍物</h4>
                    <p>AI生成的游戏机制</p>
                </div>
                
                <div class="feature-card">
                    <h4>分数和成就系统</h4>
                    <p>用户进度追踪</p>
                </div>
                
                <div class="feature-card">
                    <h4>多人游戏</h4>
                    <p>实时对战功能</p>
                </div>
            </div>
        </section>
    </div>
    
    <a href="/" class="back-to-app">🎮 返回应用</a>
    
    <script>
        // 初始化 Mermaid
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            themeVariables: {
                primaryColor: '#667eea',
                primaryTextColor: '#2c3e50',
                primaryBorderColor: '#667eea',
                lineColor: '#667eea',
                secondaryColor: '#f8f9fa',
                tertiaryColor: '#e9ecef'
            }
        });
        
        // 平滑滚动
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });
        
        // 路由处理
        function handleRouting() {
            const path = window.location.pathname;
            if (path === '/doc' || path === '/doc.html') {
                // 当前就在文档页面
                return;
            }
        }
        
        // 页面加载时处理路由
        window.addEventListener('load', handleRouting);
        
        // 监听浏览器前进后退
        window.addEventListener('popstate', handleRouting);
    </script>
</body>
</html>